<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NeoGlyph Matrix Rain 3D</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #0d0d0d;
      overflow: hidden;
      height: 100%;
    }
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      display: block;
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>
<body>
  <canvas id="layer1"></canvas>
  <canvas id="layer2"></canvas>
  <canvas id="layer3"></canvas>

  <script>
    const charset = 'アァイィウヴエェオカガキギクグケゲコゴサザシジスズセゼソゾタダチヂッヅテデトドナニヌネノハバパヒビピフブプヘベペホボポマミムメモヤユヨラリルレロワヲンabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*(){}[]<>+=-|/\\~`';

    function initMatrix(canvasId, fontSize, speed, opacity, color) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const columns = Math.floor(canvas.width / fontSize);
      const drops = Array(columns).fill(0);

      function draw() {
        ctx.fillStyle = `rgba(13, 13, 13, ${opacity})`;
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.font = fontSize + "px monospace";
        ctx.fillStyle = color;

        for (let i = 0; i < drops.length; i++) {
          const char = charset[Math.floor(Math.random() * charset.length)];
          const flippedChar = Math.random() > 0.5 ? char.split('').reverse().join('') : char;
          const x = i * fontSize;
          const y = drops[i] * fontSize;

          ctx.save();
          if (Math.random() > 0.5) ctx.scale(1, -1); // flip vertically
          ctx.fillText(flippedChar, x, y);
          ctx.restore();

          if (y > canvas.height && Math.random() > 0.975) {
            drops[i] = 0;
          }

          drops[i]++;
        }
      }

      setInterval(draw, speed);
    }

    // Layer setup (layerId, fontSize, speed, opacity, color)
    initMatrix("layer1", 16, 35, 0.08, "#00FFFF"); // cyan-ish
    initMatrix("layer2", 14, 45, 0.06, "#9966FF"); // purple
    initMatrix("layer3", 12, 60, 0.04, "#66FF99"); // mint

    window.addEventListener('resize', () => location.reload());
  </script>
</body>
</html>
