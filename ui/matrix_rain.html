<!-- ui/matrix_rain.html -->
<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<style>
  :root {
    --z: -1;                 /* keep behind Streamlit app */
    --alpha: 0.12;           /* trail opacity */
    --font: 16px monospace;  /* base font size */
  }
  html, body { margin:0; padding:0; height:0; }
  #neoCanvas {
    position: fixed; inset: 0;
    z-index: var(--z);
    pointer-events: none;
    background: radial-gradient(1200px 800px at 10% 10%, #0b1220 0%, #070b14 45%, #05070d 70%, #02040a 100%);
  }
</style>
</head>
<body>
<canvas id="neoCanvas"></canvas>
<script>
(() => {
  const canvas = document.getElementById('neoCanvas');
  const ctx = canvas.getContext('2d');

  // A fun NeoGlyph-ish set (mix of unicode shapes + your glyph chars)
  const glyphs = "Δ◉◆○⬣⬢◇✧✦✼✺✹✸✷⚚⚝⚘☼☯⌁⌇⌘⌬⌖⌗⟡⟠⟣⟟⟜░▒▓█▚▞▩▣▧▤▥▦▨▯▮▭▰▱".split("");

  const colors = [
    "#00ffd0", "#00e2ff", "#7c83ff", "#b46bff", "#ff59cf", "#ff7b66", "#ffd166", "#a1ff69"
  ];

  let w, h, cols, fontSize, drops, colorIndex = 0;

  function resize() {
    w = canvas.width  = window.innerWidth;
    h = canvas.height = window.innerHeight;
    fontSize = Math.max(14, Math.min(24, Math.floor(w / 80)));
    ctx.font = `${fontSize}px monospace`;
    cols = Math.floor(w / fontSize);
    drops = Array(cols).fill(1 + Math.floor(Math.random()*h/fontSize));
  }

  function nextColor() {
    colorIndex = (colorIndex + 1) % colors.length;
    return colors[colorIndex];
  }

  function draw() {
    // translucent clear to create trails
    ctx.fillStyle = `rgba(0,0,0,${parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--alpha'))})`;
    ctx.fillRect(0, 0, w, h);

    // occasionally shift hue to create a multicolor flow
    const stroke = nextColor();

    for (let i = 0; i < drops.length; i++) {
      const text = glyphs[Math.floor(Math.random() * glyphs.length)];
      const x = i * fontSize;
      const y = drops[i] * fontSize;

      // glow-ish composite
      ctx.shadowBlur = 8;
      ctx.shadowColor = stroke;
      ctx.fillStyle = stroke;
      ctx.fillText(text, x, y);

      if (y > h && Math.random() > 0.975) drops[i] = 0;
      drops[i]++;
    }
    requestAnimationFrame(draw);
  }

  window.addEventListener('resize', resize);
  resize();
  requestAnimationFrame(draw);
})();
</script>
</body>
</html>
